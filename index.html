<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<title>collector</title>
	<link rel="stylesheet" type="text/css" href="easyui/themes/default/easyui.css">
	<link rel="stylesheet" type="text/css" href="easyui/themes/icon.css">
	<script type="text/javascript" src="easyui/jquery.min.js"></script>
	<script type="text/javascript" src="easyui/jquery.easyui.min.js"></script>
	<style>
		.disappear {
			display: none;
		}
	</style>
</head>

<body>

	<body class="easyui-layout">
		<!-- 上面 -->
		<div data-options="region:'north',split:true" class="easyui-tabs" style="height:100px;">
			<div title="Home" style="padding:20px;display:none;">
				<a href="#" class="easyui-linkbutton" data-options="iconCls:'icon-large-smartart'"
					onclick="openFolder()">Open</a>
			</div>
			<div title="Initiated" style="overflow:auto;padding:20px;display:none;">
			</div>
		</div>
		<div data-options="region:'south',title:'Error',split:true" style="height:100px;"></div>
		<!-- 右侧 -->
		<div data-options="region:'east',title:'Tips',split:true" style="width:200px;">
			<span>The Data Entry Tool is used to collect Member System data based on the specific ICD version.
				It helps supplier validate their data entry and export a MSD file.
			</span>
		</div>
		<!-- 左侧 -->
		<div data-options="region:'west',title:'Navagation',split:true" style="width:300px;">
			<ul id="tt" class="easyui-tree">
				<li><span>Start Page</span></li>
				<li>
					<span>ICD Information</span>
					<ul>
						<li><span>Member System Modeling Data</span></li>
						<li><span>Data Load</span></li>
						<li><span>OMS Communication Message</span></li>
						<li><span>Member System Status</span></li>
					</ul>
				</li>
				<li>
					<span>Fault Reporting</span>
					<ul>
						<li><span>Basic Info</span></li>
						<li><span>Downstream Faults</span></li>
					</ul>
				</li>
				<li><span>Failure Modeling Data</span></li>
				<li>
					<span>Initiated Test</span>
					<ul>
						<li><span>Initiated Basic Info</span></li>
						<li><span>Interfering Initiated Test</span></li>
					</ul>
				</li>
			</ul>
		</div>
		<!-- 中间 -->
		<div data-options="region:'center',title:'Data Entry'" style="padding:1px;background:#eee;">
			<!-- Member System Modeling Data -->
			<div id="msmd" class="easyui-tabs " style="height:100%;width:100%;display: none;">
				<div title="Basic Information" style="padding:20px;height:100%;">
					<form id="ff" method="post">
						<div style="margin-bottom:20px">
							<input id="memName" class="easyui-textbox" name="e" style="width:800px"
								data-options="label:'Member System Name',labelWidth:300">
						</div>
						<div style="margin-bottom:20px">
							<input class="easyui-textbox" name="email" style="width:800px"
								data-options="label:'Member System ID',labelWidth:300">
						</div>
						<div style="margin-bottom:20px">
							<input class="easyui-textbox" name="subject" style="width:800px"
								data-options="label:'ATA System',labelWidth:300">
						</div>
						<div style="margin-bottom:20px">
							<select class="easyui-combobox" name="language" label="Language" style="width:800px"
								data-options="label:'Protocal type',labelWidth:300">
								<option value="ar">Arabic</option>
								<option value="bg">Bulgarian</option>
								<option value="ca">Catalan</option>
								<option value="zh-cht">Chinese Traditional</option>
							</select>
						</div>
						<div style="margin-bottom:20px">
							<input class="easyui-textbox" name="message" style="width: 800px;height:60px"
								data-options="label:'Member System Description',labelWidth:300,multiline:true">
						</div>
						<div style="margin-bottom:20px">
							<span style="display:inline-block ;width:300px">Is Optional Equipment</span>
							<input class="easyui-radiobutton" name="fruit" value="Option Equipment"
								label="Option Equipment" data-options="labelWidth:300,labelPosition:'after'">
							<input class="easyui-radiobutton" name="fruit" value="Standard Equipment"
								label="Standard Equipment" data-options="labelWidth:300,labelPosition:'after'">
						</div>
						<div style="margin-bottom:20px">
							<span style="display:inline-block ;width:300px">Transmits Reports During Power Up</span>
							<input id="accept" type="checkbox" name="accept" value="true">
						</div>

						<!-- functions -->
						<div style="margin-bottom:20px">
							<span style="display:inline-block ;width:300px">Supports Fault Reporting</span>
							<input id="accept" type="checkbox" name="accept" value="true">
						</div>
						<div style="margin-bottom:20px">
							<span style="display:inline-block ;width:300px"> Supports Initiated Test</span>
							<input id="accept" type="checkbox" name="accept" value="true">
						</div>
						<div style="margin-bottom:20px">
							<span style="display:inline-block ;width:300px"> Supports Configuration Reporting</span>
							<input id="accept" type="checkbox" name="accept" value="true">
						</div>
						<div style="margin-bottom:20px">
							<span style="display:inline-block ;width:300px">Supports Data Load</span>
							<input id="accept" type="checkbox" name="accept" value="true">
						</div>
						<div style="margin-bottom:20px">
							<span style="display:inline-block ;width:300px">Supports Fault History Retrieval</span>
							<input id="accept" type="checkbox" name="accept" value="true">
						</div>
						<div style="margin-bottom:20px">
							<span style="display:inline-block ;width:300px">Type of Fault History Retrieval</span>
							<input class="easyui-radiobutton" name="fruit" value="Option Equipment" label="Multiple"
								data-options="labelWidth:220,labelPosition:'after'">
							<input class="easyui-radiobutton" name="fruit" value="Standard Equipment" label="Single"
								data-options="labelWidth:220,labelPosition:'after'">
						</div>
						<div style="margin-bottom:20px">
							<span style="display:inline-block ;width:300px">Transmits Reports During Power Up</span>
							<input id="accept" type="checkbox" name="accept" value="true">
						</div>
						<div style="margin-bottom:20px">
							<span style="display:inline-block ;width:300px">Supports Fault History Reset</span>
							<input id="accept" type="checkbox" name="accept" value="true">
						</div>
					</form>
				</div>
				<div title="ARINC 429" style="overflow:auto;padding:20px;display:none;">
				</div>
			</div>
			<!-- Data Load -->
			<div id="dl" style="height:100%;width:100%;background-color: #E0ECFF;display:none">
				<form method="post" style="padding:20px;height:100%;">
					<div style="margin-bottom:20px">
						<input id="ProtocolType" class="easyui-textbox" name="e" style="width:900px"
							data-options="label:'OADLF Protocal Type',labelWidth:200,readonly:true">
					</div>
					<div style="margin-bottom:20px">
						<input id="resetTime" class="easyui-textbox" name="email" style="width:900px"
							data-options="label:'Reset Time',labelWidth:200">
					</div>
					<div style="margin-bottom:20px">
						<input id="LoadConditionText" class="easyui-textbox" name="subject"
							style="width:900px;word-wrap:break-word;"
							data-options="label:'Load Conditional Text',labelWidth:200">
					</div>

					<div style="margin-bottom:20px">
						<input class="easyui-textbox" name="subject" style="width:900px"
							data-options="label:'Load Attached Discrete',labelWidth:200,">
					</div>
				</form>
			</div>
			<!-- 左右两格的布局 -->
			<!-- <div class="easyui-layout" data-options="fit:true" style="height: 100%;width:100%">
				<div data-options="region:'center',split:'true',title:'Navagation'," style="width: 300px;height: 100%;">
				</div>
				<div id="BindingItems" data-options="region:'west',split:'true',title:'Navagation'"
					style="width: 300px;height: 100%;">
				</div>
			</div> -->
			<!-- Failure Modeling Data -->
			<div id="FailureModelingData" class="easyui-layout" data-options="fit:true" style="height: 100%;width:100%">
				<div data-options="region:'center',split:'true',title:'Navagation'," style="width: 300px;height: 100%;">
				</div>
				<div data-options="region:'west',split:'true',title:'Navagation'" style="width: 400px;height: 100%;">
					<div id="ppfmd" class="easyui-pagination" style="background:#efefef;border:1px solid #ccc;">
					</div>
					<div id="FailtureReportingfmd" class="easyui-panel" style="height: 560px;width:100%">

					</div>
				</div>
			</div>
			<!-- fualt Report -->
			<div id="fualtReport" class="easyui-layout" data-options="fit:true" class="easyui-tabs"
				style="height: 100%;width:100%">
				<!-- 右侧 -->
				<div data-options="region:'center',split:'true'," class="easyui-tabs"
					style="width: 300px;height: 100%;">
					<!-- 基础数据tab1 -->
					<div title="Basic Data" style="padding:20px;display:none;">
						<div style="margin-bottom:20px">
							<input id="Name" class="easyui-textbox" name="e" style="width:700px"
								data-options="label:'Fault Report Name',labelWidth:300">
						</div>
						<div style="margin-bottom:20px">
							<input id="Type" class="easyui-textbox" name="e" style="width:700px"
								data-options="label:'Fault Report Type',labelWidth:300">
						</div>
						<div style="margin-bottom:20px">
							<input id="Delay" class="easyui-textbox" name="e" style="width:700px"
								data-options="label:'Fault Report Delay',labelWidth:300">
						</div>
						<div style="margin-bottom:20px">
							<input id="Detect" class="easyui-textbox" name="e" style="width:700px"
								data-options="label:'Time Delay(Detect)',labelWidth:300">
							<span>Seconds</span>
						</div>
						<div style="margin-bottom:20px">
							<input id="Clear" class="easyui-textbox" name="e" style="width:700px"
								data-options="label:'Time Delay(Clear)',labelWidth:300">
							<span>Seconds</span>
						</div>
					</div>
					<!-- 可勾选列表tab2 -->
					<div title="Storable Fight Phase" style="overflow:auto;padding:20px;display:none;">
						<div style="margin-bottom:20px;">
							<a href="#" class="easyui-linkbutton" onclick="collapseAll()">ALL</a>
							<a href="#" class="easyui-linkbutton" onclick="expandAll()">None</a>
						</div>
						<div class="easyui-panel" style="padding:5px">
							<ul id="fightPhase" class="easyui-tree"
								data-options="data:fightPhase,animate:true,checkbox:true"></ul>
						</div>
					</div>
					<!-- tab3 -->
					<div title="Fight Deck Effect" style="overflow:auto;padding:20px;display:none;">
					</div>
				</div>
				<!-- 左侧 -->
				<div data-options="region:'west',split:'true'" style="width: 400px;height: 100%;position: relative;">
					<div id="pp" class="easyui-pagination" style="background:#efefef;border:1px solid #ccc;">
					</div>
					<div id="FaultReporting" class="easyui-panel" style="height: 560px;width:100%">

					</div>
				</div>
			</div>
		</div>
	</body>
	<script type="text/javascript">


		function openFolder() {
			console.log("hhhhhhhhhhhhhhhhhhhhhhhhhh")
			var inputObj = document.createElement('input')
			inputObj.setAttribute('id', '_ef');
			inputObj.setAttribute('type', 'file');

			inputObj.setAttribute("style", 'visibility:hidden');
			inputObj.setAttribute("accept", '.xml');

			document.body.appendChild(inputObj);
			inputObj.click();
			let a=""
			$("#_ef").change(function(){
				a=document.getElementById('_ef').value
				console.log("nnnnnn",a)
			}) 
			console.log(inputObj)
		}

		let fightPhase = [{
			"id": 1,
			"text": "Power-On"
		}, {
			"id": 2,
			"text": "Engine Start"
		},
		{
			"id": 3,
			"text": ""
		}, {
			"id": 4,
			"text": "Wife"
		}, {
			"id": 5,
			"text": "Wife"
		}, {
			"id": 6,
			"text": "Wife"
		}, {
			"id": 7,
			"text": "Wife"
		}, {
			"id": 8,
			"text": "Wife"
		}, {
			"id": 9,
			"text": "Wife"
		}, {
			"id": 10,
			"text": "Wife"
		}, {
			"id": 11,
			"text": "Wife"
		}, {
			"id": 12,
			"text": "Wife"
		}, {
			"id": 13,
			"text": "Wife"
		}, {
			"id": 14,
			"text": "Wife"
		}, {
			"id": 15,
			"text": "Wife"
		}]
		$('#tt').tree({
			onClick: function (node) {
				if (node.text == "Member System Modeling Data") {
					document.getElementById("msmd").style.display = "block"
				} else {
					document.getElementById("msmd").style.display = "none"
				}
				if (node.text == "Data Load") {
					document.getElementById("dl").style.display = "block"
				} else {
					document.getElementById("dl").style.display = "none"
				}
				if (node.text == "Data Load") {
					document.getElementById("dl").style.display = "block"
				} else {
					document.getElementById("dl").style.display = "none"
				}
				if (node.text == "Fault Reporting") {
					document.getElementById("fualtReport").style.display = "block"
				} else if (node.text == "Basic Info") {
					document.getElementById("fualtReport").style.display = "block"
				}
				else {
					document.getElementById("fualtReport").style.display = "none"
				}
				if (node.text == "Failure Modeling Data") {
					document.getElementById("FailureModelingData").style.display = "block"
				} else {
					document.getElementById("FailureModelingData").style.display = "none"
				}

				//alert(node.text);  // alert node text property when clicked
			}
		});
		let xml = {}
		$.ajax({
			type: 'GET',
			url: "test.xml",
			dataType: 'xml',
			success: function (x) {
				xml = x
				let MemberSystemModelingData = xml.getElementsByTagName("MemberSystemModelingData")
				let a = MemberSystemModelingData[0].attributes[1].value
				let BindingItems = MemberSystemModelingData[0].getElementsByTagName("BindingItems")
				let FaultReporting = xml.getElementsByTagName("FaultReporting")
				let FaultReportingData = FaultReporting[0].getElementsByTagName("FaultReportingData")
				let FailureData = FaultReporting[0].getElementsByTagName("FailureData")
				let InitiatedTestData = FaultReporting[0].getElementsByTagName("InitiatedTestData")
				//console.log("failureData",FailureData)
				getFaultReporting(FaultReportingData)
				$("#memName").textbox('setValue', a)
				getARINC615OADLFData(xml)
				getFailureData(FailureData)
				getInitiatedTest(InitiatedTestData)
			}
		})

		function getInitiatedTest(InitiatedTestData) {
			console.log(InitiatedTestData)
		}

		//分页加载一部分类别
		function getFailureDataList(pageNumber, pageSize, failureData) {
			//FailtureReportingfmd
			//清空之前的后代元素
			$("#FailtureReportingfmd").empty()
			let len = failureData.length
			let start = (pageNumber - 1) * pageSize
			let end = start + pageSize
			console.log(pageNumber, pageSize, start, end)
			for (let i = start; i < end; i++) {
				let test = failureData[i].attributes[4].value
				let FailureMessage = failureData[i].attributes[8].value
				//let DownstreamFaultsLength = FaultReportingData[i].getElementsByTagName("DownstreamFaults").length
				let a = $("<a href=\"#\" class=\"easyui-linkbutton l-btn l-btn-small easyui-fluid\"  style=\"width: 100%;padding:5px;word-wrap:break-word;\" ></a>").html(test +
					'</br>' + FailureMessage)
				$(a).click(function () {
					console.log(failureData[i].attributes)
					let temp = failureData[i].attributes

				})
				$("#FailtureReportingfmd").append(a)
			}
		}

		function getFailureData(failureData) {
			getFailureDataList(1, 10, failureData)
			let len = failureData.length
			$('#ppfmd').pagination({
				layout: ['list', 'sep', 'first', 'prev', 'sep', 'manual', 'sep', 'next', 'last', 'sep'],
				beforePageText: 'Page',
				afterPageText: 'of {pages}',
				total: len,
				pageList: [10, 20, 50, 100],
				onSelectPage: function (pageNumber, pageSize) {
					getFailureDataList(pageNumber, pageSize, failureData)
				}
			});
		}
		//分页加载一部分列表
		function getFaultReportingList(pageNumber, pageSize, FaultReportingData) {
			//清空之前的后代元素
			$("#FaultReporting").empty()

			let len = FaultReportingData.length
			let start = (pageNumber - 1) * pageSize
			let end = start + pageSize
			console.log(pageNumber, pageSize, start, end)
			for (let i = start; i < end; i++) {
				let test = FaultReportingData[i].attributes[4].value
				let DownstreamFaultsLength = FaultReportingData[i].getElementsByTagName("DownstreamFaults").length
				let a = $("<a href=\"#\" class=\"easyui-linkbutton l-btn l-btn-small easyui-fluid\"  style=\"width: 100%;padding:5px;word-wrap:break-word;\" ></a>").html(test +
					'</br>' + DownstreamFaultsLength + '&nbsp' + 'DownstreamFaults')
				$(a).click(function () {
					console.log(FaultReportingData[i].attributes)
					let temp = FaultReportingData[i].attributes
					$("#Name").textbox('setValue', temp[4].value)
					$("#Detect").textbox('setValue', temp[5].value)
					$("#Clear").textbox('setValue', temp[6].value)
					$("#Delay").textbox('setValue', temp[7].value)
					let StorableFlightPhasesActiveFault = FaultReportingData[i].getElementsByTagName("StorableFlightPhasesActiveFault")

					for (let i = 0; i < StorableFlightPhasesActiveFault.length; i++) {
						//console.log(StorableFlightPhasesActiveFault[i].textContent)
						let id = StorableFlightPhasesActiveFault[i].textContent
						fightPhase[id - 1].checked = true
					}
					//easyui数据绑定方式
					$("#fightPhase").tree({ data: fightPhase })
				})
				$("#FaultReporting").append(a)
			}
		}

		function getFaultReporting(FaultReportingData) {
			getFaultReportingList(1, 10, FaultReportingData)
			let len = FaultReportingData.length
			$('#pp').pagination({
				layout: ['list', 'sep', 'first', 'prev', 'sep', 'manual', 'sep', 'next', 'last', 'sep'],
				beforePageText: 'Page',
				afterPageText: 'of {pages}',
				total: len,
				pageList: [10, 20, 50, 100],
				onSelectPage: function (pageNumber, pageSize) {
					getFaultReportingList(pageNumber, pageSize, FaultReportingData)
				}
			});
		}

		function getARINC615OADLFData(xml) {
			let ARINC615OADLFData = xml.getElementsByTagName("ARINC615OADLFData")[0].attributes
			let resetTime = ARINC615OADLFData[1].value
			let ProtocolType = ARINC615OADLFData[2].value
			let LoadConditionText = ARINC615OADLFData[0].value
			$("#resetTime").textbox('setValue', resetTime)
			$("#ProtocolType").textbox('setValue', ProtocolType)
			$("#LoadConditionText").textbox('setValue', LoadConditionText)
			console.log("ARINC615OADLFData", ARINC615OADLFData, resetTime)
		}
	</script>
</body>

</html>